---
import "../styles/global.css";

// Defaults por p√°gina (sobrescribibles con Astro.props)
const {
  title = "Tech Hilfe Pro ‚Äì IT Service & Beratung in K√∂ln",
  desc  = "IT-Hilfe in K√∂ln: schneller, verst√§ndlicher Support f√ºr Privathaushalte & KMU. Vor Ort oder remote. Monatlich k√ºndbare Pakete."
} = Astro.props;

// Canonical absoluto seg√∫n la URL actual
const canonical = `https://techhilfepro.de${Astro.url.pathname}`;

// JSON-LD LocalBusiness (ajusta direcci√≥n real cuando la tengas)
const localBusiness = {
  "@context": "https://schema.org",
  "@type": "LocalBusiness",
  "name": "Tech Hilfe Pro ‚Äì IT Service & Beratung",
  "url": "https://techhilfepro.de",
  "image": "https://techhilfepro.de/og-image.jpg",
  "telephone": "+49 155 65029989",
  "email": "info@techhilfepro.de",
  "priceRange": "‚Ç¨‚Ç¨",
  "address": {
    "@type": "PostalAddress",
    "streetAddress": "Schirmerstr. 7", // TODO: reemplazar por direcci√≥n real
    "addressLocality": "K√∂ln",
    "postalCode": "50823",
    "addressCountry": "DE"
  },
  "areaServed": ["K√∂ln", "NRW"],
  "sameAs": ["https://wa.me/4915565029989"],
  "openingHoursSpecification": [
    { "@type": "OpeningHoursSpecification", "dayOfWeek": ["Monday","Tuesday","Wednesday","Thursday","Friday"], "opens": "09:00", "closes": "18:00" },
    { "@type": "OpeningHoursSpecification", "dayOfWeek": "Saturday", "opens": "09:00", "closes": "14:00" }
  ]
};

// JSON-LD WebSite con SearchAction (por si a√±ades buscador)
const websiteSchema = {
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "Tech Hilfe Pro",
  "url": "https://techhilfepro.de",
  "potentialAction": {
    "@type": "SearchAction",
    "target": "https://techhilfepro.de/suche?q={search_term_string}",
    "query-input": "required name=search_term_string"
  }
};
---

<html lang="de" dir="ltr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>{title}</title>
    <meta name="description" content={desc} />
    <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
    <link rel="canonical" href={canonical} />
    <link rel="alternate" href="https://techhilfepro.de" hreflang="de-DE" />

    <!-- Theming -->
    <meta name="theme-color" content="#4f46e5" />
    <meta name="color-scheme" content="light dark" />

    <!-- Open Graph -->
    <meta property="og:title" content={title} />
    <meta property="og:description" content={desc} />
    <meta property="og:type" content="website" />
    <meta property="og:url" content={canonical} />
    <meta property="og:image" content="https://techhilfepro.de/og-image.jpg" />
    <meta property="og:locale" content="de_DE" />
    <meta property="og:site_name" content="Tech Hilfe Pro" />

    <!-- Twitter Cards -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={desc} />
    <meta name="twitter:image" content="https://techhilfepro.de/og-image.jpg" />

    <!-- Favicons / PWA m√≠nimos -->
    <link rel="icon" href="/favicon.svg" type="image/svg+xml" />
    <link rel="icon" href="/favicon.ico" sizes="any" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />

    <!-- Preloads √∫tiles -->
    <link rel="preload" as="image" href="/og-image.jpg" imagesrcset="/og-image.jpg" />

    <!-- Seguridad & networking -->
    <meta name="referrer" content="strict-origin-when-cross-origin" />
    <meta http-equiv="X-Content-Type-Options" content="nosniff" />
    <link rel="preconnect" href="https://techhilfepro.de" />
    <link rel="dns-prefetch" href="https://wa.me" />

    <!-- JSON-LD -->
    <script type="application/ld+json">{JSON.stringify(localBusiness)}</script>
    <script type="application/ld+json">{JSON.stringify(websiteSchema)}</script>

    <!-- Umami Analytics (privacy-friendly) -->
    <script defer src="https://cloud.umami.is/script.js" data-website-id="56b58f40-736a-4f96-9520-3e789b49467f"></script>
  </head>

  <body class="min-h-screen bg-gray-50 text-gray-900 antialiased selection:bg-indigo-200/60">
    <!-- Skip link -->
    <a href="#main" class="sr-only focus:not-sr-only focus:absolute focus:top-2 focus:left-2 bg-indigo-600 text-white px-3 py-2 rounded">
      Zum Inhalt springen
    </a>

    <!-- Header: sin bordes, CTAs ocultas en m√≥vil, fade sutil -->
    <header class="sticky top-0 z-50 bg-white/90 backdrop-blur">
      <div class="mx-auto max-w-screen-xl px-4 md:px-6 py-3 md:py-4 flex items-center justify-between">
        <a href="/" class="font-semibold text-lg md:text-xl text-indigo-700 tracking-tight" aria-label="Tech Hilfe Pro Startseite">
          Tech Hilfe Pro
        </a>
        <nav class="hidden md:flex items-center gap-3" aria-label="Hauptnavigation">
          <a
            href="/preise"
            class="px-4 py-2 rounded-xl bg-indigo-600 text-white hover:bg-indigo-700 transition text-sm"
            data-umami-event="Header: Diagnose"
          >
            20-Min. Diagnose
          </a>
          <a
            href="https://wa.me/4915565029989?text=Hallo%2C%20ich%20brauche%20IT-Hilfe%20in%20Koeln."
            class="px-4 py-2 rounded-xl bg-emerald-500 text-white hover:bg-emerald-600 transition text-sm"
            rel="noopener"
            data-umami-event="Header: WhatsApp"
          >
            WhatsApp
          </a>
        </nav>
      </div>
      <div class="h-px md:h-1 bg-gradient-to-r from-indigo-100 via-transparent to-indigo-100"></div>
    </header>

    <!-- Main: padding extra abajo para no chocar con el sticky m√≥vil -->
    <main id="main" class="mx-auto max-w-screen-xl px-4 md:px-6 py-12 md:py-16 pb-28 md:pb-16">
      <slot />
    </main>

    <!-- Footer con desvanecido, cero l√≠neas -->
    <footer class="bg-gradient-to-t from-gray-50 via-white to-white">
      <div class="mx-auto max-w-screen-xl px-6 py-12 grid grid-cols-1 md:grid-cols-3 gap-8 text-sm">
        <!-- Marca -->
        <div>
          <div class="flex items-center gap-2">
            <span class="inline-flex h-8 w-8 items-center justify-center rounded-full bg-indigo-600 text-white font-bold">IT</span>
            <span class="font-semibold">Tech Hilfe Pro</span>
          </div>
          <p class="mt-3 text-gray-600">
            Dein IT-Partner in K√∂ln. Wir machen Technik verst√§ndlich, schnell und sicher.
          </p>
        </div>

        <!-- Navegaci√≥n -->
        <nav aria-label="Footer Navigation">
          <h3 class="font-semibold text-gray-900 mb-3">Navigation</h3>
          <ul class="space-y-2">
            <li><a class="hover:text-indigo-700" href="/">Startseite</a></li>
            <li><a class="hover:text-indigo-700" href="/privatkunden">F√ºr Privatkunden</a></li>
            <li><a class="hover:text-indigo-700" href="/geschaeftskunden">F√ºr Gesch√§ftskunden</a></li>
            <li><a class="hover:text-indigo-700" href="/kontakt">Kontakt</a></li>
            <li><a class="hover:text-indigo-700" href="/impressum">Impressum</a></li>
            <li><a class="hover:text-indigo-700" href="/datenschutz">Datenschutz</a></li>
          </ul>
        </nav>

        <!-- Contacto -->
        <div>
          <h3 class="font-semibold text-gray-900 mb-3">Kontakt</h3>
          <ul class="space-y-2 text-gray-700">
            <li>üìû <a class="hover:text-indigo-700" href="tel:+4915565029989">01556 5029989</a></li>
            <li>‚úâÔ∏è <a class="hover:text-indigo-700" href="mailto:info@techhilfepro.de">info@techhilfepro.de</a></li>
            <li>üìç K√∂ln, Nordrhein-Westfalen</li>
          </ul>
          <p class="mt-3 text-gray-700">
            Gesch√§ftszeiten:<br />
            Mo‚ÄìFr: 9:00‚Äì18:00 Uhr<br />
            Sa: 9:00‚Äì14:00 Uhr
          </p>
        </div>
      </div>

      <div class="h-1 bg-gradient-to-r from-indigo-100 via-transparent to-indigo-100"></div>

      <div class="mx-auto max-w-screen-xl px-6 py-6 text-xs text-gray-500 text-center">
        ¬© {new Date().getFullYear()} Tech Hilfe Pro. Alle Rechte vorbehalten.
      </div>
    </footer>

    <!-- Sticky CTA (solo m√≥vil) con safe-area y sombra suave -->
    <div
      class="fixed inset-x-0 bottom-0 z-40 md:hidden bg-white/95 backdrop-blur px-4 py-3 flex gap-3 justify-center shadow-[0_-6px_12px_rgba(0,0,0,.06)]"
      style="padding-bottom: calc(env(safe-area-inset-bottom) + 12px);"
    >
      <a href="/preise"
         class="flex-1 text-center px-4 py-3 rounded-xl bg-indigo-600 text-white font-medium text-sm"
         data-umami-event="Sticky: Diagnose">20-Min. Diagnose</a>
      <a href="https://wa.me/4915565029989?text=Hallo%2C%20ich%20brauche%20IT-Hilfe%20in%20Koeln."
         class="flex-1 text-center px-4 py-3 rounded-xl bg-emerald-500 text-white font-medium text-sm"
         rel="noopener" data-umami-event="Sticky: WhatsApp">WhatsApp</a>
    </div>

    <!-- Interactividad b√°sica (reveal on scroll) -->
    <script type="module" src="/scripts/reveal.js"></script>
  </body>
</html>
